<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaudiArcade</title>
    <link rel="icon" href="{{ url_for('static', filename='images/logo.png') }}" type="image/jpeg">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader" id="pageLoader">
        <div class="loader-content">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="SaudiArcade" class="loader-logo" onerror="this.style.display='none'">
            <div class="loader-spinner"></div>
            <div class="loader-text">جاري التحميل...</div>
        </div>
    </div>
<header>
    <div class="beta-banner">نسخة تجريبية</div>
        <nav>
            <div class="nav-container">
                <div class="logo-container">
                    <a href="{{ url_for('home') }}" class="logo-link">
                        <img src="{{ url_for('static', filename='images/logo.png') }}" class="site-logo" onerror="this.style.display='none'">
                        <span class="logo-text">SaudiArcade</span>
                    </a>
                </div>
                <button class="mobile-nav-toggle" id="mobileNavToggle" aria-label="قائمة الهاتف">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="{{ url_for('home') }}"><i class="fas"></i> الرئيسية</a></li>
                    <li><a href="{{ url_for('games') }}"><i class="fas"></i> الألعاب</a></li>
                    
                    {% if current_user.is_authenticated %}
                        {% if current_user.is_developer() %}
                        <li><a href="{{ url_for('upload') }}"><i class="fas "></i> رفع لعبة</a></li>
                        {% endif %}
                        <li><a href="{{ url_for('account') }}"><i class="fas"></i> حسابي</a></li>
                        <li><a href="{{ url_for('logout') }}"><i class="fas"></i> تسجيل الخروج</a></li>
                    {% else %}
                        <li><a href="{{ url_for('login') }}"><i class="fas"></i>تسجيل الدخول</a></li>
                        <li><a href="{{ url_for('register') }}"><i class="fas"></i>إنشاء حساب</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        <div class="header-line"></div>
    </header>
    <div class="flash-messages">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message flash-{{ category }}">
                        <span>{{ message }}</span>
                        <button class="flash-close" onclick="this.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>
    {% block content %}{% endblock %}

    <footer>
        <p>جميع الحقوق محفوظة &copy; 2025 سعودي اركيد</p>
    </footer>

    <script>
    const mobileNavToggle = document.getElementById('mobileNavToggle');
    const navLinks = document.getElementById('navLinks');
    const body = document.body;

    mobileNavToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        navLinks.classList.toggle('active');
        body.classList.toggle('menu-open');
        const icon = mobileNavToggle.querySelector('i');
        if (navLinks.classList.contains('active')) {
            icon.classList.replace('fa-bars', 'fa-times');
        } else {
            icon.classList.replace('fa-times', 'fa-bars');
        }
    });

        // Close menu when clicking on a link or outside
        document.addEventListener('click', (e) => {
            const isClickInsideMenu = navLinks.contains(e.target);
            const isClickOnToggle = mobileNavToggle.contains(e.target);
            
            if (!isClickInsideMenu && !isClickOnToggle && navLinks.classList.contains('active')) {
                navLinks.classList.remove('active');
                body.classList.remove('menu-open');
                mobileNavToggle.querySelector('i').classList.replace('fa-times', 'fa-bars');
            }
        });

        // Close menu when resizing to desktop
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768 && navLinks.classList.contains('active')) {
                navLinks.classList.remove('active');
                body.classList.remove('menu-open');
                mobileNavToggle.querySelector('i').classList.replace('fa-times', 'fa-bars');
            }
        });
        // Page Loader Functionality
    const pageLoader = document.getElementById('pageLoader');
    let loaderTimeout;
    
    // Show loader with a slight delay to prevent flashing on fast connections
    function showLoader() {
        clearTimeout(loaderTimeout);
        loaderTimeout = setTimeout(() => {
            document.body.classList.add('loading');
            pageLoader.classList.add('active');
        }, 300);
    }
    
    // Hide loader
    function hideLoader() {
        clearTimeout(loaderTimeout);
        document.body.classList.remove('loading');
        pageLoader.classList.remove('active');
    }
    
    // Show loader when navigating away
    document.addEventListener('click', function(e) {
        const link = e.target.closest('a');
        if (link && 
            link.href && 
            !link.href.includes('#') && 
            !link.classList.contains('no-loader') &&
            link.hostname === window.location.hostname) {
            showLoader();
        }
    });
    
    // Hide loader when page is fully loaded
    window.addEventListener('load', function() {
        hideLoader();
    });
    
    // Also hide loader if page loading fails
    window.addEventListener('error', function() {
        hideLoader();
    });
    
    // Handle browser back/forward buttons
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            hideLoader();
        }
    });
    
    // Handle form submissions
    document.addEventListener('submit', function(e) {
        const form = e.target;
        if (form && form.method === 'post') {
            showLoader();
        }
    });
    
    // Hide loader after maximum 10 seconds as a fallback
    setTimeout(hideLoader, 10000);
    </script>
</body>
</html>